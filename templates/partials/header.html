{% load static %}

<header x-data="{ mobilenavOpen: false }"
        class="md:flex items-center justify-between [&>*]:px-8 bg-gray-800 h-20 text-white sticky top-0 z-40">
    <div class="flex items-center justify-between h-20">
        <logo>
            <a class="flex items-center gap-1" href="{% url 'home' %}">
                <img class="w-7 -mt-1"
                     src="{% static 'images/fireheart_white.svg' %}" />
                <span class="text-xl font-bold font1 titleBlip">Jnestagram</span>
            </a>
        </logo>

        <a href="{% url 'home' %}"
           class="inline-flex items-center gap-1 p-2 mx-6 rounded-lg text-sm font-semibold text-violet-400  hover:bg-gray-100 transition-colors duration-200">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-violet-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l9-9 9 9M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
            </svg>
            <span class="mt-1">Home</span>
        </a>

        <mobileicon class="md:hidden">
            <a @click="mobilenavOpen = !mobilenavOpen"
               class="h-12 w-12 flex items-center justify-center cursor-pointer hover:bg-gray-700 rounded-lg">
                <img x-show="!mobilenavOpen"
                     class="w-6 h-6 select-none"
                     src="https://img.icons8.com/small/64/ffffff/menu.png" />
                <img x-show="mobilenavOpen"
                     x-cloak
                     class="w-6 h-6 select-none"
                     src="https://img.icons8.com/small/64/ffffff/delete-sign.png" />
            </a>
        </mobileicon>
    </div>
    <nav x-show="mobilenavOpen"
         x-cloak
         class="md:!block bg-gray-800 h-screen w-screen md:h-auto md:w-auto -mt-20 md:mt-0 absolute md:relative z-[-1]"
         x-transition:enter="duration-300 ease-out"
         x-transition:enter-start="opacity-0 -translate-y-96"
         x-transition:enter-end="opacity-100 translate-y-0">
        <ul class="flex items-center navitems flex-col md:flex-row gap-2 justify-center h-full -translate-y-10 md:translate-y-0">
            {% if not user.is_authenticated %}
                <li>
                    <a href="{% url 'login' %}"
                       class="flex items-center gap-2 hover:underline">
                        <img class="w-6 h-6"
                             src="https://img.icons8.com/small/64/ffffff/enter-2.png"
                             alt="enter-2" />
                        <span class="text-sm font-bold -mt-1">Login</span>
                    </a>
                </li>
            {% else %}
                <li x-data="{ dropdownOpen: false }" class="relative">
                    <a @click="dropdownOpen = !dropdownOpen"
                       @click.away="dropdownOpen = false"
                       class="cursor-pointer select-none">
                        <span class="relative flex h-8 w-8">
                            {% if pending_comments_count > 0 %}
                                <span class="absolute -top-1 -right-1 flex h-4 w-4">
                                    <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-violet-400 opacity-75"></span>
                                    <span class="relative inline-flex rounded-full h-4 w-4 bg-violet-500  items-center justify-center">
                                        <span class="text-[10px] font-bold text-white leading-none">
                                            {{ pending_comments_count }}
                                        </span>
                                    </span>
                                </span>
                            {% endif %}
                            <img class="h-full w-full rounded-full object-cover shadow-sm"
                                 src="{% if request.user.profile.avatar %}{{ request.user.profile.avatar.url }}{% else %}https://img.icons8.com/small/96/ffffff/user-male-circle.png{% endif %}" />
                        </span>
                        {{ request.user.username }}
                        <img x-bind:class="dropdownOpen && 'rotate-180 duration-300'"
                             class="w-4"
                             src="https://img.icons8.com/small/32/777777/expand-arrow.png" />
                    </a>
                    <div x-show="dropdownOpen"
                         x-cloak
                         class="absolute right-0 bg-gray-800 text-black shadow rounded-lg w-40 p-2 z-20"
                         x-transition:enter="duration-300 ease-out"
                         x-transition:enter-start="opacity-0 -translate-y-5 scale-90"
                         x-transition:enter-end="opacity-100 translate-y-0 scale-100">
                        <ul class="flex flex-col items-start hoverlist [&>li>a]:justify-end">
                            <li>
                                {% include 'partials/buttons/create_post.html' %}
                            </li>
                            <li>
                                {% include 'partials/buttons/my_profile.html' %}
                            </li>
                            <li>
                                {% include 'partials/buttons/inbox.html' %}
                            </li>
                            <li>
                                {% include 'partials/buttons/logout.html' %}
                            </li>
                        </ul>
                    </div>
                </li>
            {% endif %}
        </ul>
    </nav>
</header>
