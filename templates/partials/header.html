{% load static %}
{% load i18n %}

<header x-data="{ mobilenavOpen: false }"
        md="flex justify-between" class="items-center bg-slate-900 h-20 text-white sticky top-0 z-40 px-8">

    <div class="flex items-center justify-between h-20">
        <logo>
            <a class="flex items-center gap-1" href="{% url 'home' %}">
                <img class="w-7 mt-1" src="{% static 'images/fireheart_white.svg' %}" alt="Jnestagram-logo"/>
                <span class="text-xl font-bold font-lobster">{% trans "Jnestagram" %}</span>
            </a>
        </logo>

        <a href="{% url 'home' %}" class="nav-link md:block hidden">
            <span>{% trans "Home" %}</span>
        </a>

        <div class="md:hidden">
            <a @click="mobilenavOpen = !mobilenavOpen"
               class="h-12 w-12 flex items-center justify-center cursor-pointer hover:bg-white/10 rd-lg">
                <img x-show="!mobilenavOpen" class="w-6 h-6" src="https://img.icons8.com/small/64/ffffff/menu.png" alt="menu-icon"/>
                <img x-show="mobilenavOpen" x-cloak class=" w-6 h-6" src="https://img.icons8.com/small/64/ffffff/delete-sign.png" alt="close-menu-icon"/ />
            </a>
        </div>
    </div>
    <div class="flex items-center gap-4">
        <nav x-show="mobilenavOpen" x-cloak
             md="!block relative mt-0 h-auto w-auto z-1"
             class="bg-slate-900 h-screen w-screen absolute left-0 top-0 -mt-20 z--1"
             x-transition:enter="duration-300 ease-out"
             x-transition:enter-start="opacity-0 -translate-y-10"
             x-transition:enter-end="opacity-100 translate-y-0">

            <ul class="flex items-center flex-col md:flex-row gap-4 justify-center h-full">
                {% if not user.is_authenticated %}
                <li>
                    <a href="{% url 'login' %}" class="flex items-center gap-2 hover:underline">
                        <img class="w-6 h-6" src="https://img.icons8.com/small/64/ffffff/enter-2.png" alt="login-icon" />
                        <span class="text-sm font-bold mt-1">{% trans "Login"%}</span>
                    </a>
                </li>
                {% else %}
                <li x-data="{ dropdownOpen: false }" class="relative">
                    <a @click="dropdownOpen = !dropdownOpen" @click.away="dropdownOpen = false"
                       class="flex items-center gap-2 cursor-pointer select-none">

                        <div class="relative w-8 h-8">
                            {% if pending_comments_count|add:unread_messages_count > 0 %}
                            <span class="badge-ping">
                                    <span class="animate-ping absolute h-full w-full rd-full bg-primary opacity-75"></span>
                                    <span class="relative h-4 w-4 rd-full bg-primary flex items-center justify-center">
                                        <span text="[10px]" class="font-bold text-white">{{ pending_comments_count|add:unread_messages_count }}</span>
                                    </span>
                                </span>
                            {% endif %}
                            <img class="h-full w-full rd-full object-cover shadow-sm"
                                 src="{% if request.user.profile.avatar %}{{ request.user.profile.avatar.url }}{% else %}https://img.icons8.com/small/96/ffffff/user-male-circle.png{% endif %}"
                                 alt="{{ request.user.username }}-avatar"/>
                        </div>

                        <span class="text-sm font-bold font-lobster">{{ request.user.username }}</span>
                        <img :class="dropdownOpen && 'rotate-180'" class="duration-300 w-4"
                             src="https://img.icons8.com/small/32/777777/expand-arrow.png"
                             alt="expand-arrow-icon" />
                    </a>

                    <div x-show="dropdownOpen" x-cloak class="dropdown-card"
                         x-transition:enter="duration-200 ease-out"
                         x-transition:enter-start="opacity-0 scale-95"
                         x-transition:enter-end="opacity-100 scale-100">
                        <ul class="flex flex-col gap-1">
                            <li>{% include 'partials/buttons/create_post.html' %}</li>
                            <li>{% include 'partials/buttons/my_profile.html' %}</li>
                            <li>{% include 'partials/buttons/inbox.html' %}</li>
                            <hr class="border-white/5 my-1">
                            <li>{% include 'partials/buttons/logout.html' %}</li>
                        </ul>
                    </div>
                </li>
                {% endif %}
            </ul>
        </nav>

        {% include 'partials/switch_language.html' %}
    </div>
</header>